//===================================================================================================================================
//ÅyCredit.cppÅz
// [çÏê¨é“]HALìåãûGP12A332 11 êõñÏ é˜
// [çÏê¨ì˙]2019/09/20
// [çXêVì˙]2019/09/20
//===================================================================================================================================

//===================================================================================================================================
//ÅyÉCÉìÉNÉãÅ[ÉhÅz
//===================================================================================================================================
#include "Credit.h"
#include "Sound.h"

//===================================================================================================================================
//ÅyusingêÈåæÅz
//===================================================================================================================================
using namespace creditNS;

//===================================================================================================================================
//ÅyÉRÉìÉXÉgÉâÉNÉ^Åz
//===================================================================================================================================
Credit::Credit()
{
	// åªç›ÇÃÉVÅ[Éì(ÉNÉåÉWÉbÉg)
	sceneName = "Scene -Credit-";
	// éüÇÃÉVÅ[Éì(É^ÉCÉgÉã)
	nextScene = SceneList::TITLE;

	//ÉVÅ[ÉìÇÃçXêV
	SoundInterface::SwitchAudioBuffer(SceneList::CREDIT);

	//çƒê∂ÉpÉâÉÅÅ[É^
	PLAY_PARAMETERS playParameters[2];
	memset(playParameters, 0, sizeof(playParameters));
	playParameters[0] = { ENDPOINT_VOICE_LIST::ENDPOINT_SE, SE_LIST::SE_Decision, false,1.0f,false,NULL };
	playParameters[1] = { ENDPOINT_VOICE_LIST::ENDPOINT_BGM, BGM_LIST::BGM_Credit, true,1.0f,false,NULL };

	//çƒê∂
	SoundInterface::SE->playSound(&playParameters[0]);
	SoundInterface::BGM->playSound(&playParameters[1]);
}

//===================================================================================================================================
//ÅyÉfÉXÉgÉâÉNÉ^Åz
//===================================================================================================================================
Credit::~Credit()
{
	// ÉTÉEÉìÉhÇÃí‚é~
	SoundInterface::StopAllSound();
}

//===================================================================================================================================
//Åyèâä˙âªÅz
//===================================================================================================================================
void Credit::initialize()
{
	creditTex.initialize();
}

//===================================================================================================================================
//ÅyèIóπèàóùÅz
//===================================================================================================================================
void Credit::uninitialize()
{
	creditTex.uninitialize();
}

//===================================================================================================================================
//ÅyçXêVÅz
//===================================================================================================================================
void Credit::update(float frameTime)
{

	// ëOÇÃëJà⁄Ç÷ñﬂÇÈ
	if (input->wasKeyPressed(VK_BACK) ||
		input->getController()[PLAYER1]->wasButton(virtualControllerNS::B) ||
		input->getController()[PLAYER2]->wasButton(virtualControllerNS::B))
	{
		nextScene = SceneList::TITLE;
		changeScene(nextScene);
		return;
	}

	creditTex.update();
}

//===================================================================================================================================
//Åyï`âÊÅz
//===================================================================================================================================
void Credit::render()
{
	//1PÉJÉÅÉâÅEÉEÉBÉìÉhÉE
	//device->SetTransform(D3DTS_VIEW, &camera->view);
	//device->SetTransform(D3DTS_PROJECTION, &camera->projection);
	direct3D9->changeViewportFullWindow();
	//render3D(direct3D9);
	//UI
	renderUI(direct3D9->device);
}

//===================================================================================================================================
//Åy3Dï`âÊÅz
//===================================================================================================================================
//void Credit::render3D()
//{
//
//}

//===================================================================================================================================
//Åy2D/UIï`âÊÅz
//===================================================================================================================================
void Credit::renderUI(LPDIRECT3DDEVICE9 device)
{
	// ÉNÉåÉWÉbÉg2Dï`âÊ
	creditTex.render();
}

//===================================================================================================================================
//Åyè’ìÀîªíËèàóùÅz
//===================================================================================================================================
void Credit::collisions()
{

}

//===================================================================================================================================
//ÅyAIèàóùÅz
//===================================================================================================================================
void Credit::AI()
{

}

//===================================================================================================================================
//ÅyGUIçÏê¨èàóùÅz
//===================================================================================================================================
#ifdef _DEBUG
void Credit::createGUI()
{
	ImGui::Text(sceneName.c_str());
	ImGui::Text("sceneTime = %f", sceneTimer);
	ImGui::Text("Application average %.3f ms/frame (%.1f FPS)", 1000.0f / ImGui::GetIO().Framerate, ImGui::GetIO().Framerate);
}
#endif // _DEBUG
